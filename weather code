

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.sql.Date;
import java.util.HashMap;
import java.util.ArrayList;

import org.quickconnectfamily.json.JSONException;
import org.quickconnectfamily.json.JSONInputStream;



public class HTTP_URL_JSON_Test {
	
	
public	HTTP_URL_JSON_Test(){
		
	// creating URL to a string	
		
		String url = "http://api.worldweatheronline.com/free/v1/weather.ashx?q=83440&format=json&num_of_days=5&date=today&key=fqdenqevfzd2bdd53bcw4pp3";
		String json = new String();

		int timeout = 500;
		int status;
     //calls the url from the string and creates a connection
		try {
			URL u = new URL(url);
			HttpURLConnection c = (HttpURLConnection) u.openConnection();
			
			JSONInputStream InStream = new JSONInputStream(c.getInputStream());
			// being read as an object
			// first level hash
			// casting instream whatever comes from there to a hash map
			HashMap amap = (HashMap) InStream.readObject();
			amap.get("data");
		   
			//second level hash
			HashMap secondlvl = new HashMap();
			secondlvl = (HashMap) amap.get("data");
		//Today
		System.out.println("Today: ");
		
		//third level array casted into a hash
			ArrayList thirdlvl = (java.util.ArrayList) secondlvl.get("current_condition");
			HashMap weathercondition = (HashMap) thirdlvl.get(0);
		
			System.out.println("Temperature: " + weathercondition.get("temp_F") + "°F");
			System.out.println("Wind Speed: " + weathercondition.get("windspeedMiles") + " mph");
			System.out.println("Cloud Cover: " + weathercondition.get("cloudcover"));
			System.out.println("Precipitation: " + weathercondition.get("precipMM"));
		
			//weather loop to go through the weather array and pick out each
			// hashmap date
		
			ArrayList weatherArray = (ArrayList) secondlvl.get("weather");
					
			for (int i = 1; i < weatherArray.size(); i ++){
				HashMap three = (HashMap) weatherArray.get(i);
			    
			    System.out.println(three.get("date"));
				System.out.println("Max Temp: " + three.get("tempMaxF") + "°F");
				System.out.println("Wind Speed: " + three.get("windspeedMiles")+ " mph");
				
			}
			}
		
		
		catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			System.out.println("Bad URL");
			e.printStackTrace();
		} 
		catch (IOException e) {
			// TODO Auto-generated catch block
			System.out.println("IOException");
			e.printStackTrace();

		} catch (JSONException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		//System.out.println(url);
		System.out.println(json);


	}
}

